on:
  workflow_call:

  push:
    branches-ignore:
      - main # Exclude pushes to the main branch
    paths-ignore:
      - ".*" # Exclude all directories starting with a "."
jobs:
  make-repo-safe:
    runs-on: ubuntu-latest
    steps:
      - run: |
         git init
         git config --global --add safe.directory $(realpath .)
  spotless-check:
    uses: ./.github/workflows/spotless-check.yml
  push:
    if: ${{ failure() }}
    needs: spotless-check
    runs-on: ubuntu-latest
    steps:
      - run: |
          pwd
          ls -la
          git init
          git add .
          git commit -m "Spotless reformat"
          git push origin Workflows
